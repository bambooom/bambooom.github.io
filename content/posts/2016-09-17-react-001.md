---
draft: false
title: react 001
date: 2016-09-17 23:42:31
comments: true
---

å˜›, æ— æ•°æ¬¡å°è¯ä¸èƒ½é«˜ä¼°è‡ªå·±çš„è‡ªæ§åŠ›. äºæ˜¯åªåœ¨ä¸­ç§‹ä¸‰å¤©å‡æœŸçš„æœ€ååŠå¤©å¹²äº†ç‚¹æ­£äº‹.
(å…¶ä½™æ—¶é—´ä¸æ˜¯åƒåƒå–å–, å°±æ˜¯æ²‰è¿·æ‰‹æ¸¸é˜´é˜³å¸ˆ.....ğŸŒğŸŒšğŸŒğŸŒš)

ä¸»è¦è·Ÿç€[è¿™ä¸ªæ•™ç¨‹](https://github.com/kdchang/reactjs101)åœ¨å­¦ä¹ . æ•™ç¨‹æ˜¯ä¸ªå°æ¹¾äººå†™çš„, æœ‰ä¸­æ–‡çœ‹è¿˜æ˜¯ç®—æ¯”è¾ƒå¹¸ç¦çš„.

æ•™ç¨‹å¼€å¤´æåˆ°äº†ä¸€ç³»åˆ—çš„å·¥å…·ä»¥åŠæˆ‘å¾ˆä¸ç†Ÿæ‚‰çš„æ¨¡å—åŒ–çš„çŸ¥è¯†, äºæ˜¯ä¹Ÿé¡ºä¾¿è¡¥å……äº†ç‚¹è¿™æ–¹é¢çŸ¥è¯†.

* [ä½¿ç”¨ AMDã€CommonJS åŠ ES Harmony ç¼–å†™æ¨¡å—åŒ–çš„ JavaScript](http://justineo.github.io/singles/writing-modular-js/)
* [JavaScript æ¨¡å—åŒ–ä¸ƒæ—¥è°ˆ](http://huangxuan.me/js-module-7day/)
* [Webpack ä¸­æ–‡æŒ‡å—](http://zhaoda.net/webpack-handbook/index.html)
* [å‰ç«¯æ¨¡å—åŒ–å¼€å‘é‚£ç‚¹å†å² Â· Issue #588 Â· seajs/seajs](https://github.com/seajs/seajs/issues/588)

è¡¥å……è¿™äº›çŸ¥è¯†å°±è€—äº†ä¸å°‘æ—¶é—´, äºæ˜¯åœ¨æ·±å…¥ react ä¹‹å‰å°±å…ˆæä¸ªç¯å¢ƒè·‘å‡ºæ¥å†è¯´å§~ æ‰€ä»¥001å°±æ˜¯ä¸ª`hello world` ğŸ˜

æŒ‰ç…§[æ•™ç¨‹æŒ‡å¼•](https://github.com/kdchang/reactjs101/blob/master/Ch02/webpack-dev-enviroment.md), ä¸»è¦æ˜¯é‡‡å– webpack è®¾ç½® react çš„å¼€å‘ç¯å¢ƒ.

## 1. å®‰è£… node å’Œ npm, å¦‚æœä½ æ²¡æœ‰

```
$ node -v
```

æˆ‘ mac ä¸Š node ç‰ˆæœ¬æ˜¯6.2.0, åˆšåˆšå» node å®˜ç½‘æŸ¥çœ‹, æœ€æ–°ç‰ˆæœ¬å·²ç»æ˜¯ v6.6.0, æ›´æ–°çš„éå¸¸å¿«å•Š.

æ›´æ–° npm, æœ€æ–°ç‰ˆæœ¬æ˜¯3.10.7

```bash
$ npm install npm -g
```

## 2. åˆå§‹åŒ–ä»¥åŠ npm å®‰è£… webpack

```bash
$ mkdir react-practice
$ cd react-practice

// åˆå§‹åŒ– package.json
$ npm init

// --save-dev æ˜¯æœ¬åœ°å®‰è£…, ä¸æ˜¯ global
// ä¿å­˜ä¾èµ–åŒ…åŠç‰ˆæœ¬ä¿¡æ¯åœ¨ package.json, æ˜“äºç®¡ç†
$ npm install --save-dev babel-core babel-eslint babel-loader babel-preset-es2015 babel-preset-react html-webpack-plugin webpack webpack-dev-server
```

- babel æ˜¯ç¼–è¯‘å·¥å…·, å› ä¸º react ä¸€èˆ¬æ­é… JSX æˆ– ES6+ çš„è¯­æ³•ä¸æ˜¯åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸Šéƒ½æ”¯æŒ, babel ç¼–è¯‘ä¸º vanilla JavaScript, è®©æµè§ˆå™¨çœ‹å¾—æ‡‚. ç›¸å…³çš„JSè§„èŒƒä¹Ÿå¯è®¾ç½®, æ•™ç¨‹ä¸­ä½¿ç”¨çš„è§„èŒƒå°±æ˜¯ es2015 ä»¥åŠ react.
- webpack æ˜¯æ¨¡å—æ‰“åŒ…å·¥å…·, å®ƒå°†ç›¸å…³css/å›¾ç‰‡èµ„æºæ‰“åŒ…, æˆ–è€…å¯¹LESS/CoffeeScript/JSX/ES6ç­‰è¿›è¡Œé¢„å¤„ç†

## 3. è®¾å®š `webpack.config.js` åŠ `.babelrc`
éœ€è¦åœ¨æ ¹ç›®å½•ä¸Šè®¾ç½®.

æ•™ç¨‹å†…è®²è§£å·²ç»éå¸¸æ¸…æ¥š, è™½ç„¶å¯¹ ES6+ çš„è¯­æ³•è¿˜ä¸æ˜¯å¾ˆç†Ÿ, å€’ä¹Ÿä¸å¦¨ç¢çœ‹æ‡‚åŸºæœ¬é€»è¾‘.

```js
// HtmlWebpackPlugin æ˜¯ä¸€ä¸ªæ’ä»¶, å¯ä»¥å°†æ‰“åŒ…å¥½çš„ <script> tag æ’å…¥åˆ° html ä¸­

const HtmlWebpackPlugin = require('html-webpack-plugin');

const HTMLWebpackPluginConfig = new HtmlWebpackPlugin({
  template: `${__dirname}/app/index.html`,
  filename: 'index.html',
  inject: 'body', // æ’å…¥ä½ç½®æ˜¯ body ä¸­
});

module.exports = {
  entry: [
    './app/index.js', //èµ·å§‹æ–‡ä»¶, éœ€è¦bundle çš„, å¯ä»¥å¤šä¸ª js
  ],
  // output å°±æ˜¯æ‰“åŒ…å¥½ä¹‹åçš„æ–‡ä»¶æ”¾åœ¨ä½•å¤„
  output: {
    path: `${__dirname}/dist`, // ä¼šæ–°å»ºä¸€ä¸ª dist æ–‡ä»¶å¤¹
    filename: 'index_bundle.js', // åœ¨ dist æ–‡ä»¶å¤¹ä¸­ä¼šæ–°å»º bundle å js æ–‡ä»¶.
  },
  module: {
    loaders: [
      {
        test: /\.js$/, // æ­£åˆ™è¡¨è¾¾å¼, ç¼–è¯‘æ‰€æœ‰çš„ .js æ–‡ä»¶ä¸ºæµè§ˆå™¨å¯ä»¥è¯»æ‡‚çš„ js
        exclude: /node_modules/, //é™¤å» npm å®‰è£…çš„
        loader: 'babel-loader',
        query: {
          presets: ['es2015', 'react'],
          // ç¼–è¯‘è§„åˆ™, ä½¿ç”¨ es2015 å’Œ react
        },
      },
    ],
  },
  // devServer æ˜¯ webpack-dev-server è®¾å®š
  // webpack-dev-server æ˜¯ä¸€ä¸ªå°å·§çš„ Express server
  // inline mode ä¸æ˜¯å¤ªæ˜ç™½
  // è¿˜æœ‰äº›å…·ä½“ç»†èŠ‚éœ€è¦å‚è€ƒ http://webpack.github.io/docs/webpack-dev-server.html
  devServer: {
    inline: true,
    port: 8008,
  },
  // å°†å‰é¢è¯´çš„æ’ä»¶æ”¾å…¥
  plugins: [HTMLWebpackPluginConfig],
};
```

ä¸‹é¢æ˜¯ `.babelrc`, ä¹Ÿæ˜¯åœ¨æ ¹ç›®å½•è®¾ç½®

```js
{
  "presets": [
    "es2015",
    "react",
  ],
  "plugins": []
}
```

## 4. npm å®‰è£… react å’Œ react-dom

```bash
$ npm install --save react react-dom
```

è¿™é‡Œä¹Ÿæ˜¯æœ¬åœ°å®‰è£…

## 5. component: `index.html` å’Œ `index.js`
æ–°å»ºä¸€ä¸ª app æ–‡ä»¶å¤¹, æŠŠå®ƒä»¬ä¿©æ”¾è¿›å»

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>React Setup</title>
    <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
</head>
<body>
    <!-- æ¬²æ’å…¥ React Component çš„ä½ç½® -->
    <div id="app"></div>
</body>
</html>
```

```js
import React from 'react';
import ReactDOM from 'react-dom';

class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
    };
  }
  render() {
    return (
      <div>
        <h1>Hello, World!</h1>
      </div>
    );
  }
}

ReactDOM.render(<App />, document.getElementById('app'));
```

- `ReactDOM.render(componentæˆ–è€… html å…ƒç´ , æ’å…¥çš„ä½ç½®)`æ˜¯åŸºç¡€ç”¨æ³•.
- `index.js`å°±æ˜¯JSXè¯­æ³•, æ˜¯ä¸€ç§è¯­æ³•ç³–, ä¹Ÿå°±æ˜¯æ–¹ä¾¿ç¨‹åºå‘˜å†™ä»£ç ä¹Ÿæ–¹ä¾¿è¯»æ‡‚ä»£ç , ä½†å®é™…ä¸Šæ²¡æœ‰ä»€ä¹ˆå½±å“. æ•™ç¨‹ä½œè€…è¯´å¯ä»¥ä¸ä½¿ç”¨ JSX, ä½†åœ¨æ—¥åå†™ react component æ—¶ä¼šå‘ç°æœ‰ JSX ä¼šå¾ˆæ–¹ä¾¿.
- è¿™ä¸ªä¹Ÿå°±æ˜¯éœ€è¦ç”¨ babel æ¥ç¼–è¯‘çš„ js æ–‡ä»¶.

## 6. ç°åœ¨çš„ç›®å½•æ˜¯è¿™ä¸ªæ ·å­..

```
|____.babelrc
|____app
| |____index.html
| |____index.js
|____node_modules
|____package.json
|____webpack.config.js
```

å¯ä»¥åœ¨` package.json`ä¸­åŠ å…¥

```js
"scripts": {
  "dev": "webpack-dev-server --devtool eval --progress --colors --content-base build"
}
```

ç„¶ååœ¨ç»ˆç«¯è·‘

```bash
npm run dev
```

è¿™æ ·å°±ä¼šè‡ªåŠ¨è¿›è¡Œç¼–è¯‘åŠæ‰“åŒ…äº†.
åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `http://localhost:8008`, å°±çœ‹å¾—åˆ° `Hello, world!`

## 7. bundle åçš„ç›®å½•æ˜¯è¿™ä¸ªæ ·å­çš„

```
|____.babelrc
|____app
| |____index.html
| |____index.js
|____dist
| |____index.html
| |____index_bundle.js
|____node_modules
|____package.json
|____webpack.config.js
```

å¤šäº† `dist` æ–‡ä»¶å¤¹, å…¶ä¸­åŒ…å«çš„å°±æ˜¯ç¼–è¯‘åçš„æ–‡ä»¶, `dist` ä¸­çš„ `index.html` æ¯” `app` ä¸­çš„åœ¨ `body` å‰å¤šäº†ä¸€è¡Œ

```html
<script type="text/javascript" src="index_bundle.js"></script>
```

ä¹Ÿå°±æ˜¯å°†æ‰“åŒ…ç¼–è¯‘åçš„ js æ–‡ä»¶æ’å…¥è¿›å».

`index_bundle.js` å¯ä»¥å°†æ‰€æœ‰èµ„æºæ‰“åŒ…è¿›å», ä¹Ÿç›¸å½“äºå…å»åœ¨ html ä¸­ä¸æ–­åŠ å…¥ `<script>` çš„éº»çƒ¦å§.


### Last

è™½ç„¶ä¹Ÿå°±æ˜¯é‡å¤ä¸€æ¬¡äººå®¶çš„æ•™ç¨‹, å€’ä¹Ÿå­¦åˆ°ä¸å°‘æ–°çŸ¥è¯†.
èœé¸Ÿè¿˜éœ€ç²¾è¿›, ä»»é‡é“è¿œ.
